var __;"undefined"!=typeof wp&&wp.i18n&&void 0===__&&(wp.i18n.setLocaleData({},"webnorthcodechallenge"),__=wp.i18n.__);let getWebNorthCodeChallengeSettings=()=>({restUrl:webnorthCodeChallengeSettings?.rest_url??"",nonce:webnorthCodeChallengeSettings?.nonce??""}),loadWeatherData=async(e,t="metric")=>{var{restUrl:a,nonce:n}=getWebNorthCodeChallengeSettings();if(!a||!n)return console.error("REST URL or nonce is not defined."),null;try{var i=await fetch(a+`weather-station/${e}?units=`+t,{method:"GET",headers:{"Content-Type":"application/json","X-WP-Nonce":n}});if(!i.ok)throw new Error("HTTP error! status: "+i.status);let o=await i.json();if(!o)return console.warn("No weather data found for station ID:",e),null;let l=o.weather,r=document.querySelector("#sidebarCityContent");return r&&(r.innerHTML=`
    <div class="loading">
        <div class="loader"></div>
    </div>
`,setTimeout(()=>{r.innerHTML="";var e,t,a=document.createElement("h3");a.textContent=o.title||__("Weather Data","webnorthcodechallenge"),r.appendChild(a);for([e,t]of Object.entries(l.main)){var n=document.createElement("p"),i=e.charAt(0).toUpperCase()+e.slice(1);n.innerHTML=`<span class="fw-600">${i}:</span> `+t,r.appendChild(n)}},300)),l}catch(e){return console.error("Error fetching weather data:",e),null}};document.addEventListener("DOMContentLoaded",()=>{if("undefined"!=typeof webnorthCodeChallengeSettings&&Array.isArray(webnorthCodeChallengeSettings.weather_stations)){let i=webnorthCodeChallengeSettings.weather_stations;var e=i[0];let o=L.map("mapWrap").setView([e.lat,e.lng],6);function l(e,t,a,i=""){i&&(window.location.hash="#"+i);var o=document.querySelector("#sidebarContent");if(o){o.innerHTML="";let t=document.createElement("div");t.className="sidebar-header",t.setAttribute("data-id",i);i=document.createElement("div");i.className="temp-buttons";let a=document.createElement("button"),n=(a.id="celciusBtn",a.classList.add("active"),a.textContent=__("Celcius","webnorthcodechallenge")+" /",document.createElement("button"));n.id="fahrenheitBtn",n.innerHTML="&nbsp;"+__("Fahrenheit","webnorthcodechallenge"),i.appendChild(a),i.appendChild(n);var l=document.createElement("button"),i=(l.id="saveBtn",l.innerHTML=`
            <svg width="19" height="25" viewBox="0 0 19 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" clip-rule="evenodd"
                      d="M0.53125 2.25L1.8125 0.96875H17.1875L18.4688 2.25V24.9985L9.5 19.6837L0.53125 24.9985V2.25ZM3.09375 3.53125V20.5015L9.5 16.7051L15.9062 20.5015V3.53125H3.09375Z"
                      fill="#EEEEEE"/>
            </svg>`,t.appendChild(i),t.appendChild(l),o.appendChild(t),document.createElement("div"));i.id="sidebarCityContent",o.appendChild(i),a.addEventListener("click",async()=>{a.classList.add("active"),n.classList.remove("active");var e=t.getAttribute("data-id");e&&await loadWeatherData(e,"metric")}),n.addEventListener("click",async()=>{n.classList.add("active"),a.classList.remove("active");var e=t.getAttribute("data-id");e&&await loadWeatherData(e,"imperial")})}}L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(o),i.forEach(a=>{let n=parseFloat(a.lat),i=parseFloat(a.lng);if(n&&i){let t=L.marker([n,i]).addTo(o).bindPopup(`${__("Latitude","webnorthcodechallenge")}: ${n}<br>`+`${__("Longitude","webnorthcodechallenge")}: ${i}<br>`+a.title);t.on("click",async()=>{t.setPopupContent(`${__("Latitude","webnorthcodechallenge")}: ${n}<br>`+`${__("Longitude","webnorthcodechallenge")}: ${i}<br>`+a.title).openPopup(),l(n,i,a.title,a.id);var e=await loadWeatherData(a.id);e&&console.log("Weather data for station",a.id,e)})}}),o.on("click",async function(e){let r=e.latlng.lat,s=e.latlng.lng,d=null,c=1/0;var t,a,n;i.forEach(e=>{t=r,a=s,n=e.lat,i=e.lng,l=(o=e=>e*(Math.PI/180))(n-t),i=o(i-a),a=Math.sin(l/2)*Math.sin(l/2)+Math.cos(o(t))*Math.cos(o(n))*Math.sin(i/2)*Math.sin(i/2);var t,a,n,i,o,l=6371*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)));l<c&&(c=l,d=e)}),d&&({lat:e,lng:t,title:a,id:n}=d,o.setView([e,t],7),l(0,0,0,n),e=await loadWeatherData(n))&&console.log("Weather data (map click) for station",n,e)})}else console.warn("No weather stations data found.")}),document.addEventListener("DOMContentLoaded",function(){let t=document.querySelector(".sidebar");var e=document.getElementById("scroll-trigger"),e=(new IntersectionObserver(e=>{e[0].isIntersecting?t.classList.add("active"):t.classList.contains("active")&&t.classList.remove("active")},{threshold:.01}).observe(e),document.getElementById("sidebarMobileCurtain"));let a=0;e.addEventListener("touchstart",e=>{a=e.touches[0].clientY}),e.addEventListener("touchend",e=>{e=e.changedTouches[0].clientY-a;e<-30?t.classList.contains("close")?t.classList.remove("close"):t.classList.add("open"):30<e&&(t.classList.contains("open")?t.classList.remove("open"):t.classList.add("close"))}),(()=>{let i=CSS.supports("animation-timeline","scroll()"),o=new Map,t=!1,r=(e,t,a)=>e+(t-e)*a,s=e=>{var t=parseFloat(e);return{val:t,unit:e.replace(t,"")}},l=()=>{let e=Math.min(1,window.scrollY/(document.body.scrollHeight-window.innerHeight));o.forEach(({el:n,frames:t})=>{var a=100*e;let[i,o]=[t[0],t[t.length-1]];for(let e=0;e<t.length-1;e++)if(a>=t[e].p&&a<=t[e+1].p){[i,o]=[t[e],t[e+1]];break}let l=i.p===o.p?0:(a-i.p)/(o.p-i.p);Object.keys(i.styles).forEach(e=>{var t=s(i.styles[e]),a=s(o.styles[e]||i.styles[e]);"opacity"===e?n.style.opacity=r(t.val,a.val,l):"visibility"===e?(console.log(l),n.style.visibility=.99<l?"hidden":"visible"):t.unit===a.unit&&(n.style[e]=r(t.val,a.val,l)+t.unit)})}),t=!1};return i||addEventListener("scroll",()=>{t||(requestAnimationFrame(l),t=!0)},{passive:!0}),(e,t)=>{var a,n;i?(n=`@keyframes ${a="sa"+Math.random().toString(36).slice(2,8)}{${Object.entries(t).map(([e,t])=>`${e}{${Object.entries(t).map(([e,t])=>e+":"+t).join(";")}}`).join("")}}`,document.head.appendChild(Object.assign(document.createElement("style"),{textContent:n})),Object.assign(e.style,{animationName:a,animationDuration:"auto",animationTimeline:"scroll()"})):(o.set(e,{el:e,frames:Object.entries(t).map(([e,t])=>({p:parseFloat(e),styles:t})).sort((e,t)=>e.p-t.p)}),l())}})()(document.querySelector("header.header"),{"0%":{opacity:"1",visibility:"visible"},"100%":{opacity:"0",visibility:"hidden"}})});